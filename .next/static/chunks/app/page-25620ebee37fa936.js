(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1487:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>A});var s=a(5155),i=a(2115),o=a(6162),n=a(2087),r=a(7846);a(3574),a(8380);var l=a(6246);let c=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},d=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var u={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let m=(0,i.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:n,className:r="",children:l,iconNode:c,...m}=e;return(0,i.createElement)("svg",{ref:t,...u,width:s,height:s,stroke:a,strokeWidth:n?24*Number(o)/Number(s):o,className:d("lucide",r),...!l&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...c.map(e=>{let[t,a]=e;return(0,i.createElement)(t,a)}),...Array.isArray(l)?l:[l]])}),h=(e,t)=>{let a=(0,i.forwardRef)((a,s)=>{let{className:o,...n}=a;return(0,i.createElement)(m,{ref:s,iconNode:t,className:d("lucide-".concat(c(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),o),...n})});return a.displayName=c(e),a},v=h("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),g=h("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),p=h("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var x=a(4698),y=a(6096),f=a(63),j=a(436);function N(e){let{isAdminOn:t,categories:a,onRefresh:r}=e,l=(0,f.useRouter)(),[c,d]=(0,i.useState)(!1),[u,m]=(0,i.useState)(!1),[h,N]=(0,i.useState)(null),S=(e,t)=>{sessionStorage.setItem("activeCategory",e),sessionStorage.setItem("activeCategoryName",t),window.location.reload()},b=async()=>{if(d(!1),h){m(!0);try{await n.v.deleteCategory(h),await r()}catch(e){(0,o.A)(500,"Błąd usuwania: ".concat(e))}finally{m(!1),N(null)}}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.A,{visible:c,setVisible:d,message:"Czy na pewno chcesz usunąć tą kategorię?",textConfirm:"Tak",textCancel:"Nie",onConfirm:b}),(0,s.jsx)("main",{children:u?(0,s.jsx)(j.A,{}):(0,s.jsxs)("div",{className:"form",children:[t&&(0,s.jsx)("button",{className:"btnProperty",onClick:()=>{l.push("/add")},children:(0,s.jsx)(v,{size:24})}),(0,s.jsxs)("div",{className:"formTable no-select",children:[(0,s.jsx)("div",{className:"element elementTitle",children:"Kategorie"}),a.map(e=>(0,s.jsxs)("div",{className:"element",onClick:()=>S(e.id,e.name),role:"button",tabIndex:0,onKeyDown:t=>{"Enter"===t.key&&S(e.id,e.name)},children:[(0,s.jsx)("div",{className:"text",children:(0,y.iU)(e.name)}),t&&(0,s.jsxs)("div",{className:"btnsContent",children:[(0,s.jsx)("button",{className:"btnContent",onClick:t=>{var a,s;t.stopPropagation(),a=e.id,s=e.name,sessionStorage.setItem("activeCategory",a),sessionStorage.setItem("activeCategoryName",s),l.push("/edit")},children:(0,s.jsx)(g,{size:24})}),(0,s.jsx)("button",{className:"btnContent",onClick:t=>{t.stopPropagation(),N(e.id),d(!0)},"aria-label":"Usuń",children:(0,s.jsx)(p,{size:24})})]})]},e.id))]})]})})]})}let S=h("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);function b(e){let{isAdminOn:t,activeCategory:a,activeCategoryName:n,topics:l,refreshTopics:c}=e,d=(0,f.useRouter)(),[u,m]=(0,i.useState)(!1),[h,N]=(0,i.useState)(!1),[b,w]=(0,i.useState)(null),C=async()=>{if(N(!1),a&&b){m(!0);try{await r.s.deleteTopic(a,b),await c()}catch(e){(0,o.A)(500,"Błąd usuwania: ".concat(e))}finally{m(!1)}}},k=(e,t)=>{sessionStorage.setItem("activeTopic",e),sessionStorage.setItem("activeTopicName",t),window.location.reload()};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.A,{visible:h,setVisible:N,message:"Czy na pewno chcesz usunąć ten temat?",textConfirm:"Tak",textCancel:"Nie",onConfirm:C}),(0,s.jsx)("main",{children:u?(0,s.jsx)(j.A,{}):(0,s.jsxs)("div",{className:"form",children:[(0,s.jsx)("button",{className:"btnProperty",onClick:()=>{sessionStorage.setItem("activeCategory","Main Body"),sessionStorage.setItem("activeCategoryName","Kategorie"),sessionStorage.setItem("activeTopicName",""),d.refresh()},children:(0,s.jsx)(S,{size:24})}),t&&(0,s.jsx)("button",{className:"btnProperty",onClick:()=>{d.push("/add")},children:(0,s.jsx)(v,{size:24})}),(0,s.jsxs)("div",{className:"formTable no-select",children:[(0,s.jsx)("div",{className:"element elementTitle",children:n}),l.map(e=>(0,s.jsxs)("div",{className:"element",role:"button",tabIndex:0,onKeyDown:t=>"Enter"===t.key&&k(e.id,e.title),onClick:()=>k(e.id,e.title),children:[(0,s.jsx)("div",{className:"text",children:(0,y.iU)(e.title)}),t&&(0,s.jsxs)("div",{className:"btnsContent",children:[(0,s.jsx)("button",{className:"btnContent",onClick:t=>{var a,s;t.stopPropagation(),a=e.id,s=e.title,sessionStorage.setItem("activeTopic",a),sessionStorage.setItem("activeTopicName",s),d.push("/edit")},children:(0,s.jsx)(g,{size:24})}),(0,s.jsx)("button",{className:"btnContent",onClick:t=>{t.stopPropagation(),w(e.id),N(!0)},"aria-label":"Usuń",children:(0,s.jsx)(p,{size:24})})]})]},e.id))]})]})})]})}let w=h("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),C=h("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),k=h("pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),T=h("play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);function I(e){let{isAdminOn:t,categoryId:a,topicId:n,textTitle:l}=e,[c,d]=(0,i.useState)(""),[u,m]=(0,i.useState)(""),[h,v]=(0,i.useState)(null),[g,p]=(0,i.useState)(!0),x=(0,i.useRef)(null),[y,f]=(0,i.useState)(!1),[N,b]=(0,i.useState)(0),[I,A]=(0,i.useState)("0:00"),[z,E]=(0,i.useState)("0:00"),M=(0,i.useRef)(null),B=(0,i.useCallback)(()=>{setTimeout(()=>{var e;null==(e=M.current)||e.scrollIntoView({behavior:"smooth",block:"center"})},350)},[]),P=e=>{let t=Math.floor(e/60),a=Math.floor(e%60);return"".concat(t,":").concat(a.toString().padStart(2,"0"))};(0,i.useEffect)(()=>{!async function(){if(p(!0),!n||"Main Body"===n){d(""),m(""),v(null),p(!1);return}try{let s=await r.s.fetchTopicById(a,n);if(s){var e,t;v(s);let a=(null==(e=s.current)?void 0:e.content)||"";d(a);let i=(null==(t=s.current)?void 0:t.audioUrl)?"".concat(s.current.audioUrl,"?t=").concat(Date.now()):"";m(i)}else d(""),m(""),v(null)}catch(e){(0,o.A)(500,"Błąd ładowania tematu: ".concat(e))}finally{p(!1)}}()},[a,n]),(0,i.useEffect)(()=>{M.current&&M.current.innerText!==c&&(M.current.innerText=c)},[c]),(0,i.useEffect)(()=>{let e=x.current;e&&(async()=>{try{y?await e.play():e.pause()}catch(e){console.log("Audio play blocked by browser",e)}})()},[y]),(0,i.useEffect)(()=>{let e=x.current;if(!e)return;let t=setInterval(()=>{let t=e.currentTime,a=e.duration||0;b(a?t/a*100:0),A(P(t))},200),a=()=>{E(P(e.duration))};return e.addEventListener("loadedmetadata",a),()=>{clearInterval(t),e.removeEventListener("loadedmetadata",a)}},[u]),(0,i.useEffect)(()=>{let e=x.current;e&&(e.pause(),e.currentTime=0,e.src=u,b(0),A("0:00"),E("0:00"))},[u]);let R=async()=>{if(n)try{await r.s.updateTopicNotes(a,n,c),setTimeout(()=>{window.location.reload()},2e3)}catch(e){(0,o.A)(500,"Błąd zapisywania notatek: ".concat(e))}};return(0,s.jsx)(s.Fragment,{children:g?(0,s.jsx)("main",{children:(0,s.jsx)(j.A,{})}):(0,s.jsx)("main",{children:(0,s.jsxs)("div",{className:"form",children:[(0,s.jsxs)("div",{className:"btnsNotes",children:[(0,s.jsxs)("div",{className:"btnsNavigation",children:[(0,s.jsx)("button",{className:"btnProperty",onClick:()=>{sessionStorage.removeItem("activeTopic"),sessionStorage.removeItem("activeTopicName"),window.location.reload()},style:{marginBottom:0},children:(0,s.jsx)(S,{size:24})}),(null==h?void 0:h.behavior)&&(0,s.jsx)("button",{className:"btnProperty",onClick:()=>{var e,t;let a=null==h||null==(e=h.behavior)?void 0:e.id;a&&(sessionStorage.setItem("activeTopic",a),sessionStorage.setItem("activeTopicName",(null==h||null==(t=h.behavior)?void 0:t.title)||""),window.location.reload())},style:{marginBottom:0},children:(0,s.jsx)(w,{size:24})}),(null==h?void 0:h.next)&&(0,s.jsx)("button",{className:"btnProperty",onClick:()=>{var e,t;let a=null==h||null==(e=h.next)?void 0:e.id;a&&(sessionStorage.setItem("activeTopic",a),sessionStorage.setItem("activeTopicName",(null==h||null==(t=h.next)?void 0:t.title)||""),window.location.reload())},style:{marginBottom:0},children:(0,s.jsx)(C,{size:24})})]}),t&&(0,s.jsx)("button",{className:"btnSaveNotes",onClick:R,children:"Zapisz"})]}),(0,s.jsxs)("div",{className:"form-notes word-break",children:[(0,s.jsxs)("div",{className:"audio-player",children:[(0,s.jsxs)("div",{className:"audio-controls",children:[(0,s.jsx)("button",{className:"btnOption",onClick:()=>{f(e=>!e)},children:y?(0,s.jsx)(k,{size:24}):(0,s.jsx)(T,{size:24})}),(0,s.jsxs)("div",{style:{marginLeft:8,flexGrow:1},children:[(0,s.jsx)("progress",{value:N,max:100,className:"progress-bar",style:{width:"100%"}}),(0,s.jsxs)("div",{style:{fontSize:14},children:[I," / ",z]})]})]}),(0,s.jsx)("audio",{ref:x,preload:"metadata",onEnded:()=>f(!1)})]}),(0,s.jsx)("div",{className:"title-notes",children:l}),(0,s.jsx)("hr",{}),(0,s.jsx)("div",{style:{height:12}}),(0,s.jsx)("div",{ref:M,className:"text",contentEditable:t,suppressContentEditableWarning:!0,role:"textbox","aria-multiline":"true","data-placeholder":t?"Wprowadź notatki...":"",onFocus:B,onInput:e=>{let t=e.target;d(t.innerText),t.style.height="auto",t.style.height=t.scrollHeight+"px",t.scrollTop=t.scrollHeight},onPaste:e=>{e.preventDefault();let t=e.clipboardData.getData("text/plain"),a=window.getSelection();if(!a||!a.rangeCount)return;let s=a.getRangeAt(0);s.deleteContents();let i=document.createTextNode(t);s.insertNode(i),s.setStartAfter(i),s.setEndAfter(i),a.removeAllRanges(),a.addRange(s);let o=M.current;o&&(d(o.innerText),o.style.height="auto",o.style.height=o.scrollHeight+"px",o.scrollTop=o.scrollHeight)},spellCheck:!1,style:{whiteSpace:"pre-wrap",outline:"none",cursor:t?"text":"default",overflowY:"hidden",fontSize:"16px"}})]})]})})})}function A(){let[e,t]=(0,i.useState)(!1),[a,c]=(0,i.useState)([]),[d,u]=(0,i.useState)([]),[m,h]=(0,i.useState)(!1),[v,g]=(0,i.useState)("Main Body"),[p,x]=(0,i.useState)("Kategorie"),[y,f]=(0,i.useState)(null),[S,w]=(0,i.useState)(null),C=(0,i.useCallback)(async()=>{try{let e=await n.v.fetchCategories();if(c(e),v&&"Main Body"!==v){let e=await r.s.fetchTopics(v);u(e)}else u([])}catch(e){(0,o.A)(500,"Server error: ".concat(e))}},[v]);return(0,i.useEffect)(()=>{(async()=>{h(!0),t("true"===sessionStorage.getItem("adminStatus"));let e=sessionStorage.getItem("activeCategory"),a=sessionStorage.getItem("activeCategoryName"),s=sessionStorage.getItem("activeTopic"),i=sessionStorage.getItem("activeTopicName");e?g(e):sessionStorage.setItem("activeCategory","Main Body"),a?x(a):sessionStorage.setItem("activeCategoryName","Kategorie"),s?f(s):sessionStorage.removeItem("activeTopic"),i?w(i):sessionStorage.removeItem("activeTopicName"),await C(),h(!1)})()},[C]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.A,{categories:a,isAdminOn:e,activeCategory:v,activeCategoryName:p,activeTopic:y,activeTopicName:S,updateSelection:(e,t,a,s)=>{g(null!=e?e:"Main Body"),x(null!=t?t:"Kategorie"),f(a),w(s),e?sessionStorage.setItem("activeCategory",e):sessionStorage.removeItem("activeCategory"),t?sessionStorage.setItem("activeCategoryName",t):sessionStorage.removeItem("activeCategoryName"),a?sessionStorage.setItem("activeTopic",a):sessionStorage.removeItem("activeTopic"),s?sessionStorage.setItem("activeTopicName",s):sessionStorage.removeItem("activeTopicName"),e&&"Main Body"!==e?r.s.fetchTopics(e).then(u).catch(e=>(0,o.A)(500,"Server error: ".concat(e))):u([])}}),m?(0,s.jsx)("main",{children:(0,s.jsx)(j.A,{})}):"Main Body"===v?(0,s.jsx)(N,{isAdminOn:e,categories:a,activeCategory:v,onRefresh:C}):y?(0,s.jsx)(I,{isAdminOn:e,categoryId:v,topicId:y,textTitle:S||""}):(0,s.jsx)(b,{isAdminOn:e,activeCategory:v,activeCategoryName:p,topics:d,refreshTopics:C})]})}a(2511)},2511:()=>{},9996:(e,t,a)=>{Promise.resolve().then(a.bind(a,1487))}},e=>{e.O(0,[566,988,8,977,242,441,255,358],()=>e(e.s=9996)),_N_E=e.O()}]);